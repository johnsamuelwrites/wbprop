import{l as G,n as R,a3 as d,E as l,a2 as e,$ as u,ag as h,h as p,a1 as o,G as B,W as s,u as U,ai as H,_ as n,F as V,a4 as I,j as E}from"./vue-vendor-DZH70FcD.js";import{u as J,V as S,a as w,k as M,c as O,m as N,d as P,b as $,g as Q,n as z,s as X,t as Y,r as Z,f as ee,_ as ae}from"./index-DBPWIN5Y.js";import{S as F,Q as D}from"./query-builder-DjEuht2y.js";import"./vuetify-vendor-Cx-tRhyD.js";import"./query-cache-DYhKbuAV.js";const te={class:"search-view"},le={class:"text-subtitle-1 text-medium-emphasis mt-1"},re={class:"search-container"},oe={key:0,class:"d-flex flex-column ga-3"},se={key:0,class:"mb-3"},ne=G({__name:"SearchView",setup(ie){const m=J(),i=p(""),y=p(!1),b=p([]),c=p([]),C=p(!1),T=p(!1),f=p(null);let x=null;R(i,t=>{if(x&&clearTimeout(x),!t||t.trim().length<2){c.value=[];return}x=setTimeout(()=>K(t.trim()),300)});async function K(t){C.value=!0;try{const r=new F(m.activeConfig),_=new D(m.activeConfig).buildPropertySearchQuery(t,8),v=await r.query(_);c.value=v.results.bindings.map(g=>({id:q(g.property?.value??""),label:g.propertyLabel?.value??"",description:g.propertyDescription?.value??"",uri:g.property?.value??""}))}catch{c.value=[]}finally{C.value=!1}}async function L(){if(i.value.trim()){y.value=!0,T.value=!0,f.value=null,c.value=[];try{const t=new F(m.activeConfig),a=new D(m.activeConfig).buildPropertySearchQuery(i.value,50),_=await t.query(a);b.value=_.results.bindings.map(v=>({id:q(v.property?.value??""),label:v.propertyLabel?.value??"",description:v.propertyDescription?.value??"",uri:v.property?.value??""}))}catch(t){f.value=t instanceof Error?t.message:"Search failed",b.value=[]}finally{y.value=!1}}}function W(t){i.value=t.label,c.value=[],L()}function q(t){const r=t.match(/[PQ]\d+$/);return r?r[0]:t}function j(t){t.uri&&window.open(t.uri,"_blank")}const k=E(()=>b.value.length),A=E(()=>c.value.length>0&&i.value.trim().length>=2);return(t,r)=>(o(),d("div",te,[l(S,{class:"mb-4"},{default:e(()=>[l(w,{cols:"12"},{default:e(()=>[r[2]||(r[2]=B("h1",{class:"text-h4 font-weight-bold"},"Search Properties",-1)),B("p",le," Find properties in "+s(U(m).activeConfig.name),1)]),_:1})]),_:1}),l(S,null,{default:e(()=>[l(w,{cols:"12",md:"8",lg:"6"},{default:e(()=>[B("div",re,[l(M,{modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=a=>i.value=a),"prepend-inner-icon":"mdi-magnify",label:"Search for properties",placeholder:"e.g., instance of, date of birth",variant:"outlined",clearable:"",loading:y.value||C.value,autocomplete:"off",onKeyup:H(L,["enter"])},{append:e(()=>[l(O,{color:"primary",loading:y.value,onClick:L},{default:e(()=>[...r[3]||(r[3]=[n(" Search ",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue","loading"]),A.value?(o(),u(P,{key:0,class:"suggestions-dropdown",elevation:"8"},{default:e(()=>[l(N,{density:"compact"},{default:e(()=>[(o(!0),d(V,null,I(c.value,a=>(o(),u(z,{key:a.id,onClick:_=>W(a)},{prepend:e(()=>[l(Q,{size:"x-small",color:"primary",variant:"tonal",class:"mr-2"},{default:e(()=>[n(s(a.id),1)]),_:2},1024)]),default:e(()=>[l(X,null,{default:e(()=>[n(s(a.label),1)]),_:2},1024),a.description?(o(),u(Y,{key:0},{default:e(()=>[n(s(a.description),1)]),_:2},1024)):h("",!0)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):h("",!0)])]),_:1})]),_:1}),f.value?(o(),u(S,{key:0},{default:e(()=>[l(w,{cols:"12"},{default:e(()=>[l($,{type:"error",variant:"tonal",closable:"","onClick:close":r[1]||(r[1]=a=>f.value=null)},{default:e(()=>[n(s(f.value),1)]),_:1})]),_:1})]),_:1})):h("",!0),T.value&&!f.value?(o(),u(S,{key:1},{default:e(()=>[l(w,{cols:"12"},{default:e(()=>[y.value?(o(),d("div",oe,[(o(),d(V,null,I(5,a=>l(Z,{key:a,type:"list-item-two-line"})),64))])):(o(),d(V,{key:1},[k.value>0?(o(),d("div",se,[l(Q,{size:"small",color:"primary",variant:"tonal"},{default:e(()=>[n(s(k.value)+" "+s(k.value===1?"result":"results"),1)]),_:1})])):h("",!0),k.value>0?(o(),u(P,{key:1},{default:e(()=>[l(N,null,{default:e(()=>[(o(!0),d(V,null,I(b.value,a=>(o(),u(z,{key:a.id,title:a.label,subtitle:a.description,onClick:_=>j(a)},{prepend:e(()=>[l(Q,{size:"small",color:"primary",variant:"tonal",class:"mr-3"},{default:e(()=>[n(s(a.id),1)]),_:2},1024)]),append:e(()=>[l(ee,{size:"small",color:"medium-emphasis"},{default:e(()=>[...r[4]||(r[4]=[n("mdi-open-in-new",-1)])]),_:1})]),_:2},1032,["title","subtitle","onClick"]))),128))]),_:1})]),_:1})):(o(),u($,{key:2,type:"info",variant:"tonal"},{default:e(()=>[n(' No properties found matching "'+s(i.value)+'". ',1)]),_:1}))],64))]),_:1})]),_:1})):h("",!0)]))}}),ve=ae(ne,[["__scopeId","data-v-0cb140d9"]]);export{ve as default};
//# sourceMappingURL=SearchView-tHmxBvg1.js.map
