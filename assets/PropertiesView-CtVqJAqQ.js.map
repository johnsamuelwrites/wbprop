{"version":3,"file":"PropertiesView-CtVqJAqQ.js","sources":["../../src/views/PropertiesView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport { useWikibaseStore } from '@/stores/wikibase'\nimport { SparqlClient, QueryBuilder } from '@/services/sparql'\nimport type { SparqlResults } from '@/types'\n\nconst wikibaseStore = useWikibaseStore()\nconst search = ref('')\nconst loading = ref(false)\nconst properties = ref<Array<{ id: string; label: string; datatype: string }>>([])\nconst page = ref(1)\nconst itemsPerPage = ref(25)\n\nconst headers = [\n  { title: 'ID', key: 'id', sortable: true },\n  { title: 'Label', key: 'label', sortable: true },\n  { title: 'Datatype', key: 'datatype', sortable: true },\n]\n\nasync function loadProperties() {\n  loading.value = true\n  try {\n    const client = new SparqlClient(wikibaseStore.activeConfig)\n    const builder = new QueryBuilder(wikibaseStore.activeConfig)\n    const offset = (page.value - 1) * itemsPerPage.value\n    const query = builder.buildAllPropertiesQuery(itemsPerPage.value, offset)\n    const results: SparqlResults = await client.query(query)\n\n    properties.value = results.results.bindings.map((binding) => ({\n      id: extractId(binding.property?.value ?? ''),\n      label: binding.propertyLabel?.value ?? '',\n      datatype: extractLocalName(binding.datatype?.value ?? ''),\n    }))\n  } catch (error) {\n    console.error('Failed to load properties:', error)\n  } finally {\n    loading.value = false\n  }\n}\n\nfunction extractId(uri: string): string {\n  const match = uri.match(/[PQ]\\d+$/)\n  return match ? match[0] : uri\n}\n\nfunction extractLocalName(uri: string): string {\n  const hashIndex = uri.lastIndexOf('#')\n  const slashIndex = uri.lastIndexOf('/')\n  const separator = hashIndex > slashIndex ? hashIndex : slashIndex\n  return separator >= 0 ? uri.substring(separator + 1) : uri\n}\n\nconst filteredProperties = computed(() => {\n  if (!search.value) return properties.value\n  const searchLower = search.value.toLowerCase()\n  return properties.value.filter(\n    (p) =>\n      p.id.toLowerCase().includes(searchLower) ||\n      p.label.toLowerCase().includes(searchLower)\n  )\n})\n\n// Initial load\nloadProperties()\n</script>\n\n<template>\n  <div class=\"properties-view\">\n    <v-row class=\"mb-4\">\n      <v-col cols=\"12\">\n        <h1 class=\"text-h4 font-weight-bold\">Properties</h1>\n        <p class=\"text-subtitle-1 text-medium-emphasis mt-1\">\n          Browse all properties in {{ wikibaseStore.activeConfig.name }}\n        </p>\n      </v-col>\n    </v-row>\n\n    <v-card>\n      <v-card-title class=\"d-flex align-center\">\n        <v-text-field\n          v-model=\"search\"\n          prepend-inner-icon=\"mdi-magnify\"\n          label=\"Search properties\"\n          single-line\n          hide-details\n          density=\"compact\"\n          variant=\"outlined\"\n          class=\"mr-4\"\n          style=\"max-width: 400px\"\n        />\n        <v-spacer />\n        <v-btn\n          icon=\"mdi-refresh\"\n          variant=\"text\"\n          :loading=\"loading\"\n          @click=\"loadProperties\"\n        />\n      </v-card-title>\n\n      <v-data-table\n        :headers=\"headers\"\n        :items=\"filteredProperties\"\n        :loading=\"loading\"\n        :items-per-page=\"itemsPerPage\"\n        class=\"elevation-0\"\n      >\n        <template #item.id=\"{ item }\">\n          <v-chip size=\"small\" color=\"primary\" variant=\"tonal\">\n            {{ item.id }}\n          </v-chip>\n        </template>\n        <template #item.datatype=\"{ item }\">\n          <v-chip size=\"small\" variant=\"outlined\">\n            {{ item.datatype || 'Unknown' }}\n          </v-chip>\n        </template>\n      </v-data-table>\n    </v-card>\n  </div>\n</template>\n\n<style scoped>\n.properties-view {\n  padding: 16px;\n}\n</style>\n"],"names":["wikibaseStore","useWikibaseStore","search","ref","loading","properties","page","itemsPerPage","headers","loadProperties","client","SparqlClient","builder","QueryBuilder","offset","query","results","binding","extractId","extractLocalName","error","uri","match","hashIndex","slashIndex","separator","filteredProperties","computed","searchLower","p","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_component_v_row","_component_v_col","_cache","_createElementVNode","_hoisted_2","_unref","_component_v_card","_component_v_card_title","_component_v_text_field","$event","_component_v_spacer","_component_v_btn","_component_v_data_table","_withCtx","item","_component_v_chip","_createTextVNode","_toDisplayString"],"mappings":"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"}